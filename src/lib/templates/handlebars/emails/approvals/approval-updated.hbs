{{#> layouts/base }}

{{#*inline "content"}}
<div class="header-section">
    <h1 style="color: #059669; margin: 0; font-size: 28px; font-weight: 700;">
        ‚úèÔ∏è Approval Request Updated
    </h1>
    <div class="priority-badge priority-{{toLowerCase priority}}" style="margin-top: 12px;">
        {{#eq priority 'URGENT'}}üî¥{{/eq}}
        {{#eq priority 'HIGH'}}üü†{{/eq}}
        {{#eq priority 'MEDIUM'}}üü°{{/eq}}
        {{#eq priority 'LOW'}}üü¢{{/eq}}
        Priority: {{priority}}
    </div>
</div>

<div class="content-section">
    <p style="font-size: 16px; color: #374151; margin-bottom: 24px;">
        Hello <strong>{{name}}</strong>,
    </p>

    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin-bottom: 24px;">
        An approval request has been updated and may require your attention.
    </p>

    {{> card title="Updated Approval Details" }}
        <div class="detail-row">
            <span class="detail-label">Reference:</span>
            <span class="detail-value"><strong>{{approvalReference}}</strong></span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Title:</span>
            <span class="detail-value">{{title}}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Type:</span>
            <span class="detail-value">{{humanizeApprovalType type}}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Status:</span>
            <span class="status-badge status-{{toLowerCase status}}">{{status}}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Priority:</span>
            <span class="priority-badge priority-{{toLowerCase priority}}">{{priority}}</span>
        </div>
        {{#if requestedAmount}}
        <div class="detail-row">
            <span class="detail-label">Amount:</span>
            <span class="detail-value">{{currency}} {{formatCurrency requestedAmount}}</span>
        </div>
        {{/if}}
        {{#if deadline}}
        <div class="detail-row">
            <span class="detail-label">Deadline:</span>
            <span class="detail-value">{{formatDate deadline}}</span>
        </div>
        {{/if}}
        <div class="detail-row">
            <span class="detail-label">Last Updated:</span>
            <span class="detail-value">{{formatDateTime updatedAt}}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Version:</span>
            <span class="detail-value">{{version}}</span>
        </div>
    {{/card}}

    {{#if description}}
    {{> card title="Updated Description" }}
        <p style="margin: 0; white-space: pre-wrap;">{{description}}</p>
    {{/card}}
    {{/if}}

    {{> card title="Requester Information" }}
        <div class="detail-row">
            <span class="detail-label">Name:</span>
            <span class="detail-value">{{requesterName}}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Email:</span>
            <span class="detail-value">{{requesterEmail}}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Organization:</span>
            <span class="detail-value">{{organizationName}}</span>
        </div>
        {{#if branchName}}
        <div class="detail-row">
            <span class="detail-label">Branch:</span>
            <span class="detail-value">{{branchName}}</span>
        </div>
        {{/if}}
    {{/card}}

    {{#if updateSummary}}
    {{> card title="Update Summary" }}
        <p style="margin: 0; white-space: pre-wrap; color: #059669;">{{updateSummary}}</p>
    {{/card}}
    {{/if}}

    {{#if supportingDocuments}}
    {{> card title="Supporting Documents" }}
        <ul style="margin: 0; padding-left: 20px;">
            {{#each supportingDocuments}}
            <li style="margin-bottom: 8px;">
                <a href="{{this}}" target="_blank" style="color: #2563eb; text-decoration: none;">
                    üìé {{getFileName this}}
                </a>
            </li>
            {{/each}}
        </ul>
    {{/card}}
    {{/if}}

    {{#if entityType}}
    {{> card title="Related Information" }}
        <div class="detail-row">
            <span class="detail-label">Entity Type:</span>
            <span class="detail-value">{{humanizeEntityType entityType}}</span>
        </div>
        {{#if entityId}}
        <div class="detail-row">
            <span class="detail-label">Entity ID:</span>
            <span class="detail-value">{{entityId}}</span>
        </div>
        {{/if}}
    {{/card}}
    {{/if}}

    <div class="action-section" style="margin: 32px 0; text-align: center;">
        {{> button 
            href=approvalUrl 
            text="Review Updated Request" 
            style="primary"
        }}
        
        <div style="margin-top: 16px;">
            <a href="{{dashboardUrl}}" style="color: #6b7280; text-decoration: none; font-size: 14px;">
                Go to Dashboard
            </a>
        </div>
    </div>

    {{> alert type="info" }}
        <p style="margin: 0;">
            <strong>Important:</strong> This approval request has been updated and may contain new information. 
            Please review the changes before taking any action.
            {{#eq status 'DRAFT'}}
            The request is still in draft status and may receive additional updates.
            {{/eq}}
        </p>
    {{/alert}}

    {{#if previousComments}}
    {{> card title="Previous Comments" }}
        <p style="margin: 0; font-style: italic; color: #6b7280;">{{previousComments}}</p>
    {{/card}}
    {{/if}}
</div>

<style>
.priority-badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
}

.priority-urgent { background: #fee2e2; color: #dc2626; }
.priority-high { background: #fed7aa; color: #ea580c; }
.priority-medium { background: #fef3c7; color: #d97706; }
.priority-low { background: #dcfce7; color: #16a34a; }

.status-badge {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 500;
    text-transform: uppercase;
}

.status-draft { background: #f3f4f6; color: #6b7280; }
.status-pending { background: #fef3c7; color: #d97706; }
.status-approved { background: #dcfce7; color: #16a34a; }
.status-rejected { background: #fee2e2; color: #dc2626; }

.detail-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid #f3f4f6;
}

.detail-row:last-child {
    border-bottom: none;
    margin-bottom: 0;
}

.detail-label {
    font-weight: 600;
    color: #6b7280;
    min-width: 120px;
}

.detail-value {
    color: #374151;
    text-align: right;
    flex: 1;
}

.action-section {
    background: #f0fdf4;
    padding: 24px;
    border-radius: 8px;
    border: 1px solid #bbf7d0;
}
</style>

{{/inline}}

{{/layouts/base}} 